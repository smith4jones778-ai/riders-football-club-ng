<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Riders FC — Players</title>
  <meta name="description" content="Riders FC players directory — profiles, stats, highlights, and history.">
  <link rel="icon" href="riders-logo.jpg">

  <style>
    /* Basic theme consistent with your landing page */
    :root{
      --green:#004d1a;--accent:#007a2f;--muted:#666;
      --card-bg:#fff;--bg:#f5f9f5;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#111;}
    body{margin:0;background:var(--bg);line-height:1.6}
    header{background:var(--green);color:#fff;padding:12px 20px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:40}
    .logo{display:flex;align-items:center;gap:10px}
    .logo img{width:48px;height:48px;border-radius:50%}
    .logo h1{font-size:18px;margin:0}
    nav a{color:#fff;text-decoration:none;margin-left:12px;font-weight:800;background:linear-gradient(180deg,var(--accent),var(--green));padding:8px 12px;border-radius:10px;box-shadow:0 6px 0 #002f12}
    .container{max-width:1200px;margin:28px auto;padding:0 20px}
    .tools{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:18px}
    .search{flex:1;min-width:220px}
    .search input{width:100%;padding:12px;border-radius:10px;border:1px solid #ddd;font-weight:600}
    .filters{display:flex;gap:8px;flex-wrap:wrap}
    .filters select,.filters button{padding:10px 12px;border-radius:10px;border:1px solid #ddd;background:#fff;font-weight:700;cursor:pointer}
/* ---------- IMPROVED PLAYER GRID LAYOUT ---------- */
.grid{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(310px, 1fr));
  gap: 25px;
}

/* ---------- IMPROVED PLAYER CARD ---------- */
.player-card{
  background: var(--card-bg);
  padding: 18px;
  border-radius: 18px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.10);
  cursor: pointer;
  transition: transform .20s, box-shadow .20s;
  display: flex;
  gap: 18px;
  align-items: center;
  min-height: 150px;
}

.player-card:hover{
  transform: translateY(-7px);
  box-shadow: 0 14px 30px rgba(0,0,0,0.18);
}

/* ---------- PLAYER IMAGE (Bigger + Premium Border) ---------- */
.thumb{
  width: 100px;
  height: 130px;
  border-radius: 16px;
  overflow: hidden;
  border: 5px solid var(--green);
  flex-shrink: 0;
}

.thumb img{
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* ---------- TEXT DETAILS (More visible + structured) ---------- */
.meta{
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.meta h3{
  margin: 0;
  color: var(--green);
  font-size: 20px;
  font-weight: 900;
}

.meta p{
  margin: 0;
  color: var(--muted);
  font-weight: 700;
  font-size: 15px;
}

/* ---------- VALUE BADGE (Aligned + Bigger) ---------- */
.badge{
  background: var(--accent);
  color: #fff;
  padding: 10px 14px;
  border-radius: 12px;
  font-weight: 900;
  font-size: 14px;
  white-space: nowrap;
  display: flex;
  align-items: center;
  height: fit-content;
  box-shadow: 0 6px 14px rgba(0,0,0,0.25);
}

    .empty{padding:40px;text-align:center;color:#777}

/* Modal Backdrop */
.modal-backdrop{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:200;
    padding:20px;
    overflow-y:auto; /* Allow scrolling on small screens */
}

/* Modal Container */
.modal{
    width:100%;
    max-width:980px;
    background:#fff;
    border-radius:14px;
    box-shadow:0 18px 60px rgba(0,0,0,0.5);
    overflow:hidden;

    /* prevents modal from being cut off */
    max-height:95vh;
    overflow-y:auto;
}

/* Profile Layout */
.profile-hero{
    display:flex;
    gap:20px;
    padding:20px;
    background:linear-gradient(180deg,#f8fff8,#f1fff4);
    flex-wrap:wrap;
}

/****** LEFT SECTION ******/
.left{
    width:260px;
    max-width:100%;
    text-align:center;
    padding:10px;
    margin:auto;
}

/* Portrait Player Image */
.left .photo{
    width:240px;
    height:340px; /* Portrait ratio */
    border-radius:12px;
    overflow:hidden;
    margin:0 auto;
    border:6px solid var(--green);
}

.left .photo img{
    width:100%;
    height:100%;
    object-fit:contain; /* No cropping, full image */
    background:#fff;
}

.left h2{
    color:var(--green);
    margin:12px 0 6px;
}

.left p{
    color:var(--muted);
    font-weight:700;
}

/****** RIGHT SECTION ******/
.right{
    flex:1;
    padding:8px 6px 0;
}

.info-row{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:16px;
}

.info-card{
    background:#fff;
    border-radius:10px;
    padding:10px 12px;
    border:1px solid #eee;
    min-width:120px;
    font-weight:800;
}

/* Tabs */
.tabs{
    display:flex;
    gap:6px;
    padding:10px;
    border-top:1px solid #f0f0f0;
}

.tab-btn{
    padding:10px 14px;
    border-radius:10px;
    border:none;
    background:transparent;
    cursor:pointer;
    font-weight:800;
}

.tab-btn.active{
    background:var(--green);
    color:#fff;
}

.tab-content{
    padding:20px;
    max-height:360px;
    overflow:auto;
}

/* Stats */
.stat-grid{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
}

.stat{
    background:#f8fff8;
    border-radius:10px;
    padding:12px;
    min-width:120px;
    text-align:center;
    font-weight:900;
    color:var(--green);
}

/* Gallery */
.gallery{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
}

.gallery a{
    display:block;
    width:110px;
    height:90px;
    border-radius:8px;
    overflow:hidden;
}

.gallery img{
    width:100%;
    height:100%;
    object-fit:cover;
}

/* ------------------------------------------------------------------ */
/* RESPONSIVE BREAKPOINTS                                             */
/* ------------------------------------------------------------------ */

/*********** TABLETS & SMALL PHONES ***********/
@media(max-width:768px){

    .modal{
        max-height:100vh;
        border-radius:10px;
    }

    .profile-hero{
        flex-direction:column;
        align-items:center;
        text-align:center;
    }

    .left{
        width:100%;
        margin-bottom:20px;
    }

    .left .photo{
        width:70%;
        height:auto;
        aspect-ratio:3/4; /* Always portrait */
    }

    .right{
        width:100%;
        padding:10px;
    }

    .info-row, .stat-grid{
        justify-content:center;
    }

    .tab-content{
        max-height:50vh; /* More scroll space on small screen */
    }
}

/*********** VERY SMALL PHONES ***********/
@media(max-width:480px){

    .left .photo{
        width:90%;
        aspect-ratio:3/4;
    }

    .info-card{
        min-width:48%;
    }

    .stat{
        min-width:45%;
    }

    .gallery a{
        width:48%;
        height:100px;
    }
}


    /* small screens */
    @media(max-width:820px){.profile-hero{flex-direction:column}.left{width:100%}.left .photo{width:160px;height:160px}}

  </style>
</head>
<body>

<header>
  <div class="logo">
    <img src="riders-logo.jpg" alt="logo">
    <h1>Riders FC — Players</h1>
  </div>
  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
  </nav>
</header>

<main class="container">
  <div class="tools">
    <div class="search"><input id="q" placeholder="Search players by name, position, or country..." /></div>

    <div class="filters">
      <select id="posFilter">
        <option value="">All Positions</option>
        <option>Goalkeeper</option><option>Defender</option><option>Midfielder</option><option>Forward</option>
      </select>

      <select id="sortBy">
        <option value="name">Sort: Name (A–Z)</option>
        <option value="value_desc">Market Value (High → Low)</option>
        <option value="goals_desc">Goals (High → Low)</option>
      </select>

      <button id="clearBtn">Clear</button>
    </div>
  </div>

  <div id="playersGrid" class="grid"></div>
  <div id="empty" class="empty" style="display:none">No players found. Ask admin to add players.</div>
</main>

<!-- Modal -->
<div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
  <div class="modal" role="document">
    <div class="profile-hero">
      <div class="left">
        <div class="photo"><img id="pPhoto" src="default-player.jpg" alt="player"></div>
        <h2 id="pName">Player Name</h2>
        <p id="pRole">Position • Jersey #</p>
        <div style="margin-top:10px"><span id="pValue" class="badge">€0</span></div>
      </div>

      <div class="right">
        <div class="info-row" id="basicInfoRow">
          <!-- dynamic info-cards -->
        </div>

        <div class="tabs" role="tablist">
          <button class="tab-btn active" data-tab="overview">Overview</button>
          <button class="tab-btn" data-tab="stats">Stats</button>
          <button class="tab-btn" data-tab="history">Career</button>
          <button class="tab-btn" data-tab="media">Media</button>
        </div>

        <div class="tab-content" id="tabContent">
          <!-- dynamic tab content -->
        </div>
      </div>
    </div>
<a class="video-thumb" href="video.mp4">
    <img src="thumbnail.jpg" />
</a>

    <div style="text-align:right;padding:12px;border-top:1px solid #f0f0f0">
      <button id="closeModal" style="padding:10px 14px;border-radius:10px;border:none;background:#f1f1f1;font-weight:800;cursor:pointer">Close</button>
      <a id="openInNew" href="#" target="_blank" style="padding:10px 14px;margin-left:8px;border-radius:10px;background:var(--green);color:#fff;text-decoration:none;font-weight:900">Open Full Profile</a>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
/* ------------------ FIREBASE ------------------ */
  const firebaseConfig = {
    apiKey: "AIzaSyB6e3aosFBjX4ulFs5NhdpSY_9XmE0w_kc",
    authDomain: "website-83a2b.firebaseapp.com",
    databaseURL: "https://website-83a2b-default-rtdb.firebaseio.com",
    projectId: "website-83a2b",
    storageBucket: "website-83a2b.firebasestorage.app",
    messagingSenderId: "10021438632",
    appId: "1:10021438632:web:892b3b49af06503ece6e9d"
  };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ------------------ FLAG FIX ------------------ */
const COUNTRY_MAP = {
  "nigeria":"ng","ghana":"gh","england":"gb","united kingdom":"gb","uk":"gb",
  "spain":"es","france":"fr","germany":"de","italy":"it","portugal":"pt",
  "brazil":"br","argentina":"ar","cameroon":"cm","senegal":"sn","south africa":"za",
  "ivory coast":"ci","cote d'ivoire":"ci","netherlands":"nl","belgium":"be",
  "usa":"us","united states":"us","canada":"ca","mexico":"mx","sweden":"se",
  "norway":"no","denmark":"dk","switzerland":"ch","poland":"pl","turkey":"tr"
};

function getFlagURL(country){
  if(!country) return "";
  const iso = COUNTRY_MAP[country.trim().toLowerCase()];
  return iso ? `https://flagcdn.com/w40/${iso}.png` : "";
}

/* ------------------ DOM SHORTCUT ------------------ */
const $ = id => document.getElementById(id);

const grid = $('playersGrid');
const empty = $('empty');
const qInput = $('q');
const posFilter = $('posFilter');
const sortBy = $('sortBy');
const clearBtn = $('clearBtn');

const backdrop = $('modalBackdrop');
const pPhoto = $('pPhoto');
const pName = $('pName');
const pRole = $('pRole');
const pValue = $('pValue');
const basicInfoRow = $('basicInfoRow');
const tabContent = $('tabContent');
const openInNew = $('openInNew');

let allPlayers = {};

/* ------------------ FETCH PLAYERS ------------------ */
firebase.database().ref("players").on("value", snap => {
  allPlayers = snap.val() || {};
  renderPlayers(allPlayers);
});

/* ------------------ RENDER CARDS ------------------ */
function renderPlayers(obj){
  grid.innerHTML = "";
  const arr = Object.keys(obj).map(id => ({id, ...obj[id]}));

  const q = qInput.value.toLowerCase().trim();
  const pos = posFilter.value;

  let filtered = arr.filter(p=>{
    if(!p) return false;

    const published = p.published !== false;
    if(!published) return false;

    const name=(p.name||"").toLowerCase();
    const position=(p.position||"").toLowerCase();
    const nat=(p.nationality||"").toLowerCase();
    const club=(p.club||"").toLowerCase();

    const matchesQ =
      !q ||
      name.includes(q) ||
      position.includes(q) ||
      nat.includes(q) ||
      club.includes(q);

    const matchesPos = !pos || p.position === pos;

    return matchesQ && matchesPos;
  });

  // Sort
  if(sortBy.value === "name") filtered.sort((a,b)=>a.name.localeCompare(b.name));
  if(sortBy.value === "value_desc") filtered.sort((a,b)=>(b.marketValue||0)-(a.marketValue||0));
  if(sortBy.value === "goals_desc") filtered.sort((a,b)=>(b.goals||0)-(a.goals||0));

  if(filtered.length === 0){
    empty.style.display = "block";
    return;
  }
  empty.style.display = "none";

  filtered.forEach(p=>{
    const flag = getFlagURL(p.nationality);
    const card = document.createElement("div");
    card.className = "player-card";

    card.innerHTML = `
      <div class="thumb">
        <img src="${escapeHtml(p.photoURL || 'default-player.jpg')}">
      </div>

      <div class="meta">
        <h3>${escapeHtml(p.name)}</h3>
        <p style="display:flex;align-items:center;gap:6px">
            ${flag ? `<img src="${flag}" style="width:24px;height:18px;border-radius:3px;object-fit:cover">` : ""}
            ${escapeHtml(p.position||"—")} • ${escapeHtml(p.nationality||"—")} • #${escapeHtml(p.jersey||"—")}
        </p>
      </div>

      <div class="badge">€${formatNumber(p.marketValue||0)}</div>
    `;

    card.onclick = ()=> openProfile(p.id, p);
    grid.appendChild(card);
  });
}

/* ------------------ PROFILE MODAL ------------------ */
function openProfile(id, p){
  if(!p || !p.name){
    db.ref("players/"+id).once("value").then(s=> openProfile(id, s.val()));
    return;
  }

  pPhoto.src = p.photoURL || "default-player.jpg";
  pName.textContent = p.name;
  pRole.textContent = `${p.position||'—'} • #${p.jersey||'—'}`;
  pValue.textContent = `€${formatNumber(p.marketValue||0)}`;

  basicInfoRow.innerHTML="";
  addInfoCard("Age", p.age||"—");
  addInfoCard("Nationality", p.nationality||"—");
  addInfoCard("Height", p.height||"—");
  addInfoCard("Weight", p.weight||"—");
  addInfoCard("Foot", p.foot||"—");

  showTabContent("overview", p);

  openInNew.href = `player-profile.html?id=${id}`;

  backdrop.style.display = "flex";
  backdrop.setAttribute("aria-hidden","false");
}

function addInfoCard(label,val){
  const div=document.createElement("div");
  div.className="info-card";
  div.innerHTML = `
    <div style="font-size:12px;color:#777">${escapeHtml(label)}</div>
    <div style="font-size:16px">${escapeHtml(val)}</div>
  `;
  basicInfoRow.appendChild(div);
}

/* ------------------ TABS ------------------ */
document.querySelectorAll(".tab-btn").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll(".tab-btn").forEach(x=>x.classList.remove("active"));
    btn.classList.add("active");

    const tab = btn.dataset.tab;
    const current = Object.values(allPlayers).find(x=>x.name===pName.textContent);
    showTabContent(tab, current);
  });
});

function showTabContent(tab,p){
  if(!p){ tabContent.innerHTML="<p>No data.</p>"; return;}

  if(tab==="overview"){
    tabContent.innerHTML = `
      <h3 style="color:var(--green);margin-top:0">${escapeHtml(p.name)}</h3>
      <p style="font-weight:700">${escapeHtml(p.bio || "No biography provided.")}</p>
      <hr>
      <p><strong>Current Club:</strong> ${escapeHtml(p.club||"Riders FC")}</p>
      <p><strong>Contract:</strong> ${escapeHtml(p.contractUntil||"—")}</p>
    `;
  }

  else if(tab==="stats"){
    tabContent.innerHTML = `
      <div class="stat-grid">
        <div class="stat">Apps<br>${p.appearances||0}</div>
        <div class="stat">Goals<br>${p.goals||0}</div>
        <div class="stat">Assists<br>${p.assists||0}</div>
        <div class="stat">Yellow<br>${p.yellow||0}</div>
        <div class="stat">Red<br>${p.red||0}</div>
        <div class="stat">Mins<br>${p.minutes||0}</div>
      </div>
    `;
  }

  else if(tab==="history"){
    const hist=p.careerHistory||[];
    let html="<h4>Career History</h4>";
    if(!hist.length){
      html+="<p style='color:#777'>No history provided.</p>";
    } else {
      html+="<ul>";
      hist.forEach(h=>{
        html+=`<li><strong>${escapeHtml(h.team||"—")}</strong> (${escapeHtml(h.from||"—")}–${escapeHtml(h.to||"—")}) – ${escapeHtml(h.notes||"")}</li>`;
      });
      html+="</ul>";
    }
    tabContent.innerHTML=html;
  }

  else if(tab==="media"){
    let html="<h4>Gallery</h4>";
    const gallery = Array.isArray(p.gallery)?p.gallery:(p.gallery?[p.gallery]:[]);
    if(!gallery.length){
      html+="<p style='color:#777'>No gallery images.</p>";
    } else {
      html+=`<div class="gallery">`;
      gallery.forEach(url=>{
        html+=`<a href="${escapeHtml(url)}" target="_blank"><img src="${escapeHtml(url)}"></a>`;
      });
      html+=`</div>`;
    }

    html+="<hr><h4>Highlights & Video Links</h4>";
    const vids = Array.isArray(p.videos)?p.videos:(p.videos?[p.videos]:[]);
    if(!vids.length){
      html+="<p style='color:#777'>No videos added.</p>";
    } else {
      html+="<ul>";
      vids.forEach(v=> html += `<li><a href="${escapeHtml(v)}" target="_blank">${escapeHtml(shortenUrl(v))}</a></li>`);
      html+="</ul>";
    }

    tabContent.innerHTML=html;
  }
}

/* ------------------ EVENTS ------------------ */
$('closeModal').onclick = ()=> closeModal();
backdrop.onclick = e=>{ if(e.target===backdrop) closeModal(); };

function closeModal(){
  backdrop.style.display="none";
  backdrop.setAttribute("aria-hidden","true");
}

qInput.oninput = debounce(()=> renderPlayers(allPlayers), 150);
posFilter.onchange = ()=> renderPlayers(allPlayers);
sortBy.onchange = ()=> renderPlayers(allPlayers);

clearBtn.onclick = ()=>{
  qInput.value="";
  posFilter.value="";
  sortBy.value="name";
  renderPlayers(allPlayers);
};

/* ------------------ HELPERS ------------------ */
function formatNumber(n){ return Number(n||0).toLocaleString(); }
function shortenUrl(u){ return u.length>50 ? u.slice(0,50)+"..." : u; }
function escapeHtml(s){
  return String(s||"").replace(/[&<>\"']/g,c=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[c]));
}
function debounce(fn,ms){ let t; return (...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),ms);} }
</script>


</body>
</html>
